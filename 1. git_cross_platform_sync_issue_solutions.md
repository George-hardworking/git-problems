### README: There are [English Version](#english-version) and [ä¸­æ–‡ç‰ˆæœ¬](#chinese-version) in this .md file.  

# <span id="english-version">English Version</span>: GitHub Cross-System Synchronization Issue Report

## ğŸ“… Issue Overview
**Date**: October 15, 2024
**Systems Involved**: Mac (Primary Local), Windows (Backup), Linux (Lab Server)
**Core Issue**: Line ending conflicts and duplicate commit problems when synchronizing Git across different systems

## ğŸ”¥ Problem Sequence Encountered

### Problem 1: False File Modifications
**Phenomenon**: GitHub Desktop shows files as modified, but the actual modifications were made on the Linux server

**Error Message**: `Unable to pull when changes are present on your branch.`

### Problem 2: Duplicate Local Commits
**Phenomenon**: 75 local commits appeared waiting to be pushed, but these commits already existed in the remote repository

### Problem 3: Git Process Lock Conflicts
**Phenomenon**: `zsh: bus error` and lock file errors

## ğŸ•µï¸ Root Cause Analysis

### Primary Cause: Line Ending Differences
- **Linux/Mac**: Use `LF` (Line Feed)
- **Windows**: Use `CRLF` (Carriage Return + Line Feed)
- **Inconsistent Git configuration** causes identical files to be recognized as "modified" on different systems

### Secondary Causes:
1. **Git process abnormal exit** leads to residual lock files
2. **Simultaneous operations between GitHub Desktop and terminal** cause process conflicts
3. **Metadata changes** (file permissions, timestamps) misidentified as content modifications

## ğŸ› ï¸ Solutions and Code

### Phase 1: Unified Git Configuration  

Create a unified **.gitconfig** file:  
`For Windows systems, execute the following code:` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=true
git config --global core.safecrlf warn
git config --global pull.rebase false
```
Note: Use crlf when editing on Windows, but lf is used when submitting to the repository.  

`For Mac systems, execute the following code:` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
```  
Note: Some older versions of Mac do not use lf, so it is necessary to uniformly change it to lf.  

`For Linux systems, execute the following code` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
git config --global core.filemode false
```  
Note: In the server, changes in permissions may be considered as noise, so the filemode has been changed to false.

### Phase 2: Clean Up Current Issues
```bash
# Remove lock files (if encountering process conflicts)
rm -f .git/index.lock
rm -f .git/refs/remotes/origin/main.lock

# Discard local false modifications
git checkout -- .

# Force synchronize to remote state
git fetch origin
git reset --hard origin/main

# Verify status
git status
```

### Phase 3: Fix Duplicate Commits
```bash
# View redundant local commits
git log --oneline origin/main..main

# Force reset (after confirming these commits are indeed duplicates)
git reset --hard origin/main
```

## ğŸš« Preventive Measures

### 1.Unified Git Configuration Across All Systems

Create a unified .gitconfig file:
```bash
# Execute on all systems
git config --global core.autocrlf input
git config --global core.safecrlf warn
git config --global core.eol lf
git config --global pull.rebase false
```

### 2.Standardized Workflow

```bash
# Before starting work
git fetch origin
git status

# Check changes before committing
git diff --check

# Use correct commit workflow
git add .
git commit -m "message"
git pull --rebase origin main
git push origin main
```
## ğŸ“‹ Recommended Workflow

### âœ… Before each cross-system work session:
1. Execute git fetch to check remote status
2. Execute git status to confirm clean working directory
3. If there are modifications, commit or stash them before switching systems

### âœ… When encountering synchronization issues:
1. Close all Git clients (Desktop, IDE)  
2. Execute repair commands in the terminal in sequence
3. Do not operate the same repository from multiple locations simultaneously

### âœ… Long-term maintenance:
1. Maintain consistent Git configuration across all systems
2. Regularly execute `git gc` to maintain repository health

## ğŸ¯ Summary
By unifying configurations and standardizing workflows, cross-system Git synchronization issues can be completely eliminated. The key lies in prevention over problem-solving - **establishing protective mechanisms before problems occur**.  

# <span id="chinese-version">ä¸­æ–‡ç‰ˆæœ¬</span>ï¼šGitHub è·¨ç³»ç»ŸåŒæ­¥é—®é¢˜æŠ¥å‘Š

## ğŸ“… é—®é¢˜æ¦‚è¿°
**æ—¥æœŸ**ï¼š2025å¹´10æœˆ15æ—¥  
**æ¶‰åŠç³»ç»Ÿ**ï¼šMac (æœ¬åœ°ä¸»åŠ›)ã€Windows (å¤‡ç”¨)ã€Linux (æœåŠ¡å™¨)  
**æ ¸å¿ƒé—®é¢˜**ï¼šGit åœ¨ä¸åŒç³»ç»Ÿé—´åŒæ­¥æ—¶å‡ºç°çš„è¡Œå°¾ç¬¦å†²çªå’Œé‡å¤æäº¤é—®é¢˜

## ğŸ”¥ é‡åˆ°çš„é—®é¢˜åºåˆ—

### é—®é¢˜1ï¼šè™šå‡çš„æ–‡ä»¶ä¿®æ”¹
**ç°è±¡**ï¼šGitHub Desktop æ˜¾ç¤ºæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œä½†å®é™…ä¿®æ”¹æ˜¯åœ¨ Linux æœåŠ¡å™¨ä¸Šè¿›è¡Œçš„

**é”™è¯¯ä¿¡æ¯**ï¼šUnable to pull when changes are present on your branch.   

### é—®é¢˜2ï¼šé‡å¤çš„æœ¬åœ°æäº¤
**ç°è±¡**ï¼šå‡ºç°75ä¸ªæœ¬åœ°æäº¤ç­‰å¾…æ¨é€ï¼Œä½†å®é™…è¿™äº›æäº¤å·²ç»å­˜åœ¨äºè¿œç¨‹ä»“åº“

### é—®é¢˜3ï¼šGit è¿›ç¨‹é”å†²çª
**ç°è±¡**ï¼š`zsh: bus error` å’Œé”æ–‡ä»¶é”™è¯¯  


## ğŸ•µï¸ æ ¹æœ¬åŸå› åˆ†æ

### ä¸»è¦åŸå› ï¼šè¡Œå°¾ç¬¦å·®å¼‚
- **Linux/Mac**ï¼šä½¿ç”¨ `LF` (Line Feed)
- **Windows**ï¼šä½¿ç”¨ `CRLF` (Carriage Return + Line Feed)
- **Git é…ç½®ä¸ä¸€è‡´**å¯¼è‡´ç›¸åŒæ–‡ä»¶åœ¨ä¸åŒç³»ç»Ÿä¸Šè¢«è¯†åˆ«ä¸º"å·²ä¿®æ”¹"

### æ¬¡è¦åŸå› ï¼š
1. **Git è¿›ç¨‹å¼‚å¸¸é€€å‡º**å¯¼è‡´é”æ–‡ä»¶æ®‹ç•™
2. **GitHub Desktop ä¸ç»ˆç«¯åŒæ—¶æ“ä½œ**é€ æˆè¿›ç¨‹å†²çª
3. **å…ƒæ•°æ®å˜åŒ–**ï¼ˆæ–‡ä»¶æƒé™ã€æ—¶é—´æˆ³ï¼‰è¢«è¯¯åˆ¤ä¸ºå†…å®¹ä¿®æ”¹

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆä¸ä»£ç 

### é˜¶æ®µ1ï¼šç»Ÿä¸€ Git é…ç½®

```bash
# åœ¨ Mac ä¸Šæ‰§è¡Œ
git config --global core.autocrlf input
git config --global core.eol lf

# åœ¨ Linux æœåŠ¡å™¨ä¸Šæ‰§è¡Œ  
git config --global core.autocrlf input
git config --global core.eol lf

# åœ¨ Windows ä¸Šæ‰§è¡Œ
git config --global core.autocrlf true
git config --global core.eol crlf  
```

### é˜¶æ®µ2ï¼šæ¸…ç†å½“å‰é—®é¢˜
```bash
# åˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚é‡è¿›ç¨‹å†²çªï¼‰
rm -f .git/index.lock
rm -f .git/refs/remotes/origin/main.lock

# æ”¾å¼ƒæœ¬åœ°è™šå‡ä¿®æ”¹
git checkout -- .

# å¼ºåˆ¶åŒæ­¥åˆ°è¿œç¨‹çŠ¶æ€
git fetch origin
git reset --hard origin/main

# éªŒè¯çŠ¶æ€
git status
```

### é˜¶æ®µ3ï¼šä¿®æ”¹é‡å¤æäº¤
```bash
# æŸ¥çœ‹æœ¬åœ°å¤šä½™çš„æäº¤
git log --oneline origin/main..main

# å¼ºåˆ¶é‡ç½®ï¼ˆç¡®è®¤è¿™äº›æäº¤ç¡®å®é‡å¤åï¼‰
git reset --hard origin/main
```

## ğŸš« é¢„é˜²æªæ–½

### 1.ç»Ÿä¸€æ‰€æœ‰ç³»ç»Ÿçš„Gité…ç½®

åˆ›å»ºç»Ÿä¸€çš„ **.gitconfig** æ–‡ä»¶ï¼š  
`åœ¨Windowsç³»ç»Ÿä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=true
git config --global core.safecrlf warn
git config --global pull.rebase false
```
å¤‡æ³¨ï¼šåœ¨Windowsä¸Šç¼–è¾‘æ—¶ç”¨crlfï¼Œä½†æäº¤åˆ°ä»“åº“çš„æ˜¯lf  
`åœ¨Macç³»ç»Ÿä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
```
å¤‡æ³¨ï¼šéƒ¨åˆ†è€ç‰ˆæœ¬Macä½¿ç”¨çš„ä¸æ˜¯lfï¼Œå› æ­¤éœ€è¦ç»Ÿä¸€ä¸ºlf  
`åœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
git config --global core.filemode false
```
å¤‡æ³¨ï¼šåœ¨æœåŠ¡å™¨ä¸­ï¼Œæƒé™å˜åŒ–å¯èƒ½ä¼šæ˜¯å™ªéŸ³ï¼Œå› æ­¤å°†filemodeæ”¹ä¸ºfalse

### 2.è§„èŒƒå·¥ä½œæµç¨‹

```bash
# å·¥ä½œå‰
git fetch origin
git status

# æäº¤å‰æ£€æŸ¥å˜åŒ–
git diff --check

# ä½¿ç”¨æ­£ç¡®çš„æäº¤æµç¨‹
git add .
git commit -m "message"
git pull --rebase origin main
git push origin main
```
## ğŸ“‹ å»ºè®®å·¥ä½œæµç¨‹

### âœ… æ¯æ¬¡è·¨ç³»ç»Ÿå·¥ä½œå‰ï¼š
1. æ‰§è¡Œ `git fetch` æŸ¥çœ‹è¿œç¨‹çŠ¶æ€
2. æ‰§è¡Œ `git status` ç¡®è®¤å·¥ä½œåŒºå¹²å‡€
3. å¦‚æœ‰ä¿®æ”¹ï¼Œå…ˆæäº¤æˆ–å‚¨è—å†åˆ‡æ¢ç³»ç»Ÿ

### âœ… é‡åˆ°åŒæ­¥é—®é¢˜æ—¶ï¼š
1. å…³é—­æ‰€æœ‰ Git å®¢æˆ·ç«¯ï¼ˆDesktopã€IDEï¼‰
2. åœ¨ç»ˆç«¯ä¸­æŒ‰é¡ºåºæ‰§è¡Œä¿®å¤å‘½ä»¤
3. ä¸è¦åœ¨å¤šå¤„åŒæ—¶æ“ä½œåŒä¸€ä»“åº“

### âœ… é•¿æœŸç»´æŠ¤ï¼š
1. ä¿æŒæ‰€æœ‰ç³»ç»Ÿçš„ Git é…ç½®ä¸€è‡´
2. å®šæœŸæ‰§è¡Œ `git gc` ç»´æŠ¤ä»“åº“å¥åº·

## ğŸ¯ æ€»ç»“

é€šè¿‡ç»Ÿä¸€é…ç½®ã€è§„èŒƒå·¥ä½œæµç¨‹ï¼Œå¯ä»¥å½»åº•æœç»è·¨ç³»ç»Ÿ Git åŒæ­¥é—®é¢˜ã€‚å…³é”®åœ¨äº**é¢„é˜²ä¼˜äºè§£å†³é—®é¢˜** - åœ¨é—®é¢˜å‘ç”Ÿå‰å»ºç«‹é˜²æŠ¤æœºåˆ¶ã€‚

---
