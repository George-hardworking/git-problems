### README: There are [English Version](#english-version) and [中文版本](#chinese-version) in this .md file.  

# <span id="english-version">English Version</span>: GitHub Cross-System Synchronization Issue Report

## 📅 Issue Overview
**Date**: October 15, 2024
**Systems Involved**: Mac (Primary Local), Windows (Backup), Linux (Lab Server)
**Core Issue**: Line ending conflicts and duplicate commit problems when synchronizing Git across different systems

## 🔥 Problem Sequence Encountered

### Problem 1: False File Modifications
**Phenomenon**: GitHub Desktop shows files as modified, but the actual modifications were made on the Linux server

**Error Message**: `Unable to pull when changes are present on your branch.`

### Problem 2: Duplicate Local Commits
**Phenomenon**: 75 local commits appeared waiting to be pushed, but these commits already existed in the remote repository

### Problem 3: Git Process Lock Conflicts
**Phenomenon**: `zsh: bus error` and lock file errors

## 🕵️ Root Cause Analysis

### Primary Cause: Line Ending Differences
- **Linux/Mac**: Use `LF` (Line Feed)
- **Windows**: Use `CRLF` (Carriage Return + Line Feed)
- **Inconsistent Git configuration** causes identical files to be recognized as "modified" on different systems

### Secondary Causes:
1. **Git process abnormal exit** leads to residual lock files
2. **Simultaneous operations between GitHub Desktop and terminal** cause process conflicts
3. **Metadata changes** (file permissions, timestamps) misidentified as content modifications

## 🛠️ Solutions and Code

### Phase 1: Unified Git Configuration  

Create a unified **.gitconfig** file:  
`For Windows systems, execute the following code:` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=true
git config --global core.safecrlf warn
git config --global pull.rebase false
```
Note: Use crlf when editing on Windows, but lf is used when submitting to the repository.  

`For Mac systems, execute the following code:` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
```  
Note: Some older versions of Mac do not use lf, so it is necessary to uniformly change it to lf.  

`For Linux systems, execute the following code` 
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
git config --global core.filemode false
```  
Note: In the server, changes in permissions may be considered as noise, so the filemode has been changed to false.

### Phase 2: Clean Up Current Issues
```bash
# Remove lock files (if encountering process conflicts)
rm -f .git/index.lock
rm -f .git/refs/remotes/origin/main.lock

# Discard local false modifications
git checkout -- .

# Force synchronize to remote state
git fetch origin
git reset --hard origin/main

# Verify status
git status
```

### Phase 3: Fix Duplicate Commits
```bash
# View redundant local commits
git log --oneline origin/main..main

# Force reset (after confirming these commits are indeed duplicates)
git reset --hard origin/main
```

## 🚫 Preventive Measures

### 1.Unified Git Configuration Across All Systems

Create a unified .gitconfig file:
```bash
# Execute on all systems
git config --global core.autocrlf input
git config --global core.safecrlf warn
git config --global core.eol lf
git config --global pull.rebase false
```

### 2.Standardized Workflow

```bash
# Before starting work
git fetch origin
git status

# Check changes before committing
git diff --check

# Use correct commit workflow
git add .
git commit -m "message"
git pull --rebase origin main
git push origin main
```
## 📋 Recommended Workflow

### ✅ Before each cross-system work session:
1. Execute git fetch to check remote status
2. Execute git status to confirm clean working directory
3. If there are modifications, commit or stash them before switching systems

### ✅ When encountering synchronization issues:
1. Close all Git clients (Desktop, IDE)  
2. Execute repair commands in the terminal in sequence
3. Do not operate the same repository from multiple locations simultaneously

### ✅ Long-term maintenance:
1. Maintain consistent Git configuration across all systems
2. Regularly execute `git gc` to maintain repository health

## 🎯 Summary
By unifying configurations and standardizing workflows, cross-system Git synchronization issues can be completely eliminated. The key lies in prevention over problem-solving - **establishing protective mechanisms before problems occur**.  

# <span id="chinese-version">中文版本</span>：GitHub 跨系统同步问题报告

## 📅 问题概述
**日期**：2025年10月15日  
**涉及系统**：Mac (本地主力)、Windows (备用)、Linux (服务器)  
**核心问题**：Git 在不同系统间同步时出现的行尾符冲突和重复提交问题

## 🔥 遇到的问题序列

### 问题1：虚假的文件修改
**现象**：GitHub Desktop 显示文件被修改，但实际修改是在 Linux 服务器上进行的

**错误信息**：Unable to pull when changes are present on your branch.   

### 问题2：重复的本地提交
**现象**：出现75个本地提交等待推送，但实际这些提交已经存在于远程仓库

### 问题3：Git 进程锁冲突
**现象**：`zsh: bus error` 和锁文件错误  


## 🕵️ 根本原因分析

### 主要原因：行尾符差异
- **Linux/Mac**：使用 `LF` (Line Feed)
- **Windows**：使用 `CRLF` (Carriage Return + Line Feed)
- **Git 配置不一致**导致相同文件在不同系统上被识别为"已修改"

### 次要原因：
1. **Git 进程异常退出**导致锁文件残留
2. **GitHub Desktop 与终端同时操作**造成进程冲突
3. **元数据变化**（文件权限、时间戳）被误判为内容修改

## 🛠️ 解决方案与代码

### 阶段1：统一 Git 配置

```bash
# 在 Mac 上执行
git config --global core.autocrlf input
git config --global core.eol lf

# 在 Linux 服务器上执行  
git config --global core.autocrlf input
git config --global core.eol lf

# 在 Windows 上执行
git config --global core.autocrlf true
git config --global core.eol crlf  
```

### 阶段2：清理当前问题
```bash
# 删除锁文件（如遇进程冲突）
rm -f .git/index.lock
rm -f .git/refs/remotes/origin/main.lock

# 放弃本地虚假修改
git checkout -- .

# 强制同步到远程状态
git fetch origin
git reset --hard origin/main

# 验证状态
git status
```

### 阶段3：修改重复提交
```bash
# 查看本地多余的提交
git log --oneline origin/main..main

# 强制重置（确认这些提交确实重复后）
git reset --hard origin/main
```

## 🚫 预防措施

### 1.统一所有系统的Git配置

创建统一的 **.gitconfig** 文件：  
`在Windows系统上执行以下代码：`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=true
git config --global core.safecrlf warn
git config --global pull.rebase false
```
备注：在Windows上编辑时用crlf，但提交到仓库的是lf  
`在Mac系统上执行以下代码：`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
```
备注：部分老版本Mac使用的不是lf，因此需要统一为lf  
`在Linux系统上执行以下代码：`
```bash
git config --global user.name "Your User Name"
git config --global user.email "Your User Email"
git core.autocrlf=input
git core.eol=lf
git config --global core.safecrlf warn
git config --global pull.rebase false
git config --global core.filemode false
```
备注：在服务器中，权限变化可能会是噪音，因此将filemode改为false

### 2.规范工作流程

```bash
# 工作前
git fetch origin
git status

# 提交前检查变化
git diff --check

# 使用正确的提交流程
git add .
git commit -m "message"
git pull --rebase origin main
git push origin main
```
## 📋 建议工作流程

### ✅ 每次跨系统工作前：
1. 执行 `git fetch` 查看远程状态
2. 执行 `git status` 确认工作区干净
3. 如有修改，先提交或储藏再切换系统

### ✅ 遇到同步问题时：
1. 关闭所有 Git 客户端（Desktop、IDE）
2. 在终端中按顺序执行修复命令
3. 不要在多处同时操作同一仓库

### ✅ 长期维护：
1. 保持所有系统的 Git 配置一致
2. 定期执行 `git gc` 维护仓库健康

## 🎯 总结

通过统一配置、规范工作流程，可以彻底杜绝跨系统 Git 同步问题。关键在于**预防优于解决问题** - 在问题发生前建立防护机制。

---
